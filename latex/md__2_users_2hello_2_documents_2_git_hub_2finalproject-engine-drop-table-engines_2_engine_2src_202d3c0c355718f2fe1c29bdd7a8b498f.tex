\chapter{signal-\/exit}
\hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f}{}\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f}\index{signal-\/exit@{signal-\/exit}}
\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5185}%
\Hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5185}%


When you want to fire an event no matter how a process exits\+:


\begin{DoxyItemize}
\item reaching the end of execution.
\item explicitly having {\ttfamily process.\+exit(code)} called.
\item having {\ttfamily process.\+kill(pid, sig)} called.
\item receiving a fatal signal from outside the process
\end{DoxyItemize}

Use {\ttfamily signal-\/exit}.


\begin{DoxyCode}{0}
\DoxyCodeLine{//\ Hybrid\ module,\ either\ works}
\DoxyCodeLine{import\ \{\ onExit\ \}\ from\ 'signal-\/exit'}
\DoxyCodeLine{//\ or:}
\DoxyCodeLine{//\ const\ \{\ onExit\ \}\ =\ require('signal-\/exit')}
\DoxyCodeLine{}
\DoxyCodeLine{onExit((code,\ signal)\ =>\ \{}
\DoxyCodeLine{\ \ console.log('process\ exited!',\ code,\ signal)}
\DoxyCodeLine{\})}

\end{DoxyCode}
\hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5186}{}\doxysection{\texorpdfstring{API}{API}}\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5186}
{\ttfamily remove = on\+Exit((code, signal) =\texorpdfstring{$>$}{>} \{\}, options)}

The return value of the function is a function that will remove the handler.

Note that the function {\itshape only} fires for signals if the signal would cause the process to exit. That is, there are no other listeners, and it is a fatal signal.

If the global {\ttfamily process} object is not suitable for this purpose (ie, it\textquotesingle{}s unset, or doesn\textquotesingle{}t have an {\ttfamily emit} method, etc.) then the {\ttfamily on\+Exit} function is a no-\/op that returns a no-\/op {\ttfamily remove} method.\hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5187}{}\doxysubsection{\texorpdfstring{Options}{Options}}\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5187}

\begin{DoxyItemize}
\item {\ttfamily always\+Last}\+: Run this handler after any other signal or exit handlers. This causes {\ttfamily process.\+emit} to be monkeypatched.
\end{DoxyItemize}\hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5188}{}\doxysubsection{\texorpdfstring{Capturing Signal Exits}{Capturing Signal Exits}}\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5188}
If the handler returns an exact boolean {\ttfamily true}, and the exit is a due to signal, then the signal will be considered handled, and will {\itshape not} trigger a synthetic {\ttfamily process.\+kill(process.\+pid, signal)} after firing the {\ttfamily on\+Exit} handlers.

In this case, it your responsibility as the caller to exit with a signal (for example, by calling {\ttfamily process.\+kill()}) if you wish to preserve the same exit status that would otherwise have occurred. If you do not, then the process will likely exit gracefully with status 0 at some point, assuming that no other terminating signal or other exit trigger occurs.

Prior to calling handlers, the {\ttfamily on\+Exit} machinery is unloaded, so any subsequent exits or signals will not be handled, even if the signal is captured and the exit is thus prevented.

Note that numeric code exits may indicate that the process is already committed to exiting, for example due to a fatal exception or unhandled promise rejection, and so there is no way to prevent it safely.\hypertarget{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5189}{}\doxysubsection{\texorpdfstring{Browser Fallback}{Browser Fallback}}\label{md__2_users_2hello_2_documents_2_git_hub_2finalproject-engine-drop-table-engines_2_engine_2src_202d3c0c355718f2fe1c29bdd7a8b498f_autotoc_md5189}
The `\textquotesingle{}signal-\/exit/browser'\`{} module is the same fallback shim that just doesn\textquotesingle{}t do anything, but presents the same function interface.

Patches welcome to add something that hooks onto {\ttfamily window.\+onbeforeunload} or similar, but it might just not be a thing that makes sense there. 