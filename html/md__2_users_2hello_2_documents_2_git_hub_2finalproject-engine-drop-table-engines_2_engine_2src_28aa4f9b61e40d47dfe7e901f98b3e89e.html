<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: @electron/osx-sign &lt;a href=&quot;https://npmjs.org/package/@electron/osx-sign&quot; &gt;&lt;img src=&quot;https://img.shields.io/npm/v/@electron/osx-sign.svg&quot; alt=&quot;npm&quot;/&gt;&lt;/a&gt; &lt;a href=&quot;https://circleci.com/gh/electron/osx-sign&quot; &gt;&lt;img src=&quot;https://img.shields.io/circleci/build/github/electron/osx-sign&quot; alt=&quot;Build Status&quot;/&gt;&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">@electron/osx-sign &lt;a href="https://npmjs.org/package/@electron/osx-sign" &gt;&lt;img src="https://img.shields.io/npm/v/@electron/osx-sign.svg" alt="npm"/&gt;&lt;/a&gt; &lt;a href="https://circleci.com/gh/electron/osx-sign" &gt;&lt;img src="https://img.shields.io/circleci/build/github/electron/osx-sign" alt="Build Status"/&gt;&lt;/a&gt;</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md510"></a></p>
<p>Codesign Electron macOS apps</p>
<h1><a class="anchor" id="autotoc_md511"></a>
About</h1>
<p><a href="https://github.com/electron/osx-sign"><code>@electron/osx-sign</code></a> minimizes the extra work needed to eventually prepare your apps for shipping, providing options that work out of the box for most applications. Additional configuration is available via its API.</p>
<p>There are two main functionalities exposed via this package:</p><ul>
<li>Signing macOS apps via <code>sign</code> functions. Under the hood, this uses the <code>codesign</code> utility.</li>
<li>Creating <code>.pkg</code> installer packages via <code>flat</code> functions. Under the hood, this uses the <code>productbuild</code> utility.</li>
</ul>
<h1><a class="anchor" id="autotoc_md512"></a>
Installation</h1>
<p><code>@electron/osx-sign</code> is integrated into other Electron packaging tools, and can be configured accordingly:</p><ul>
<li><a href="https://electron.github.io/packager/main/types/OsxSignOptions.html">Electron Packager</a></li>
<li><a href="https://www.electronforge.io/guides/code-signing/code-signing-macos">Electron Forge</a></li>
</ul>
<p>You can also install <code>@electron/osx-sign</code> separately if your packaging pipeline does not involve those tools:</p>
<div class="fragment"><div class="line">npm install --save-dev @electron/osx-sign</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md513"></a>
Code signing</h1>
<p>The signing procedure implemented in this package is based on what described in Electron's <a href="https://github.com/electron/electron/blob/main/docs/tutorial/code-signing.md">Code Signing Guide</a>.</p>
<h2><a class="anchor" id="autotoc_md514"></a>
Prerequisites</h2>
<ul>
<li>You must be a registered member of the <a href="https://developer.apple.com/programs/">Apple Developer Program</a>. Please note that you could be charged by Apple in order to get issued with the required certificates.</li>
<li>You must have <a href="https://developer.apple.com/xcode/">Xcode</a> installed from the <a href="https://apps.apple.com/us/app/xcode/id497799835">Mac App Store</a>. It is not recommended to download your copy from other 3rd party sources for security reasons.</li>
<li>You must have Xcode Command Line Tools installed. To check whether it is available, try <code>xcode-select --install</code> and follow the instructions.</li>
<li>To distribute your app on the Mac App Store, You must create a Mac App on <a href="https://appstoreconnect.apple.com/">App Store Connect</a>.</li>
<li>You must give your app a unique Bundle ID.</li>
<li>You must give your app a version number.</li>
</ul>
<h2><a class="anchor" id="autotoc_md515"></a>
Certificates</h2>
<p>In order to distribute your application either inside or outside the Mac App Store, you will have to have the following certificates from Apple after becoming a registered developer.</p>
<p>Certificates can be created through the <a href="https://developer.apple.com/account/resources/certificates/add">Certificates, Identities &amp; Profiles</a> page in the Apple Developer website or via <a href="https://help.apple.com/xcode/mac/current/#/dev3a05256b8">Account Preferences in Xcode</a>.</p>
<p>For distribution inside the Mac App Store, you will need to create:</p><ul>
<li>Mac App Distribution: <code>3rd Party Mac Developer Application: * (*)</code></li>
<li>Mac Installer Distribution: <code>3rd Party Mac Developer Installer: * (*)</code></li>
</ul>
<p>For distribution outside the Mac App Store:</p><ul>
<li>Developer ID Application: <code>Developer ID Application: * (*)</code></li>
<li>Developer ID Installer: <code>Developer ID Installer: * (*)</code></li>
</ul>
<p>After you create the necessary certifications, download them and open each so that they are installed in your keychain. We recommend installing them in your system default keychain so that <code>@electron/osx-sign</code> can detect them automatically.</p>
<p><b>Note:</b> They appear to come in pairs. It is preferred to have every one of them installed so not to are about which is not yet installed for future works. However, if you may only want to distribute outside the Mac App Store, there is no need to have the 3rd Party Mac Developer ones installed and vice versa.</p>
<h2><a class="anchor" id="autotoc_md516"></a>
API</h2>
<div class="fragment"><div class="line">const { signAsync } = require(&#39;@electron/osx-sign&#39;)</div>
<div class="line">const opts = {</div>
<div class="line">  app: &#39;path/to/my.app&#39;</div>
<div class="line">};</div>
<div class="line">signAsync(opts)</div>
<div class="line">  .then(function () {</div>
<div class="line">    // Application signed</div>
<div class="line">  })</div>
<div class="line">  .catch(function (err) {</div>
<div class="line">    // Handle the error</div>
<div class="line">  })</div>
</div><!-- fragment --><p>The only mandatory option for <code>signAsync</code> is a path to your <code>.app</code> package. Configuration for most Electron apps should work out of the box. For full configuration options, see the [API documentation].</p>
<h2><a class="anchor" id="autotoc_md517"></a>
Usage examples</h2>
<h3><a class="anchor" id="autotoc_md518"></a>
Signing for Mac App Store distribution</h3>
<div class="fragment"><div class="line">const { signAsync } = require(&#39;@electron/osx-sign&#39;)</div>
<div class="line">const opts = {</div>
<div class="line">  app: &#39;path/to/my.app&#39;,</div>
<div class="line">  // optional parameters for additional customization</div>
<div class="line">  platform: &quot;mas&quot;, // should be auto-detected if your app was packaged for MAS via Packager or Forge</div>
<div class="line">  type: &quot;distribution&quot;, // defaults to &quot;distribution&quot; for submission to App Store Connect</div>
<div class="line">  provisioningProfile: &#39;path/to/my.provisionprofile&#39;, // defaults to the current working directory</div>
<div class="line">  keychain: &#39;my-keychain&#39;, // defaults to the system default login keychain</div>
<div class="line">};</div>
<div class="line">signAsync(opts)</div>
<div class="line">  .then(function () {</div>
<div class="line">    // Application signed</div>
<div class="line">  })</div>
<div class="line">  .catch(function (err) {</div>
<div class="line">    // Handle the error</div>
<div class="line">  })</div>
</div><!-- fragment --><p>Mac App Store apps require a <a href="https://www.electronjs.org/docs/latest/tutorial/mac-app-store-submission-guide#prepare-provisioning-profile">Provisioning Profile</a> for submission to App Store Connect. We recommend having the provisioning profile for distribution placed in the current working directory and the signing identity installed in the default keychain.</p>
<p>The app is not expected to run after codesigning since there is no provisioned device, and it is intended only for submission to App Store Connect. Since <code>@electron/osx-sign</code> adds the entry <code>com.apple.developer.team-identifier</code> to a temporary copy of the specified entitlements file (with the default option <code>preAutoEntitlements</code>), distribution builds can no longer be run directly.</p>
<p>To run an app codesigned for distribution locally after codesigning, you may manually add <code>ElectronTeamID</code> in your <code>Info.plist</code> and <code>com.apple.security.application-groups</code> in the entitlements file, and set <code>preAutoEntitlements: false</code> for <code>@electron/osx-sign</code> to avoid this extra bit. Note that "certain features are only allowed across apps whose team-identifier value match" (<a href="https://developer.apple.com/library/content/technotes/tn2415/_index.html#//apple_ref/doc/uid/DTS40016427-CH1-ENTITLEMENTSLIST">Technical Note TN2415</a>).</p>
<p>Alternatively, set the app's <code>type</code> to <code>development</code> to codesign a development version of your app, which will allow it to be run on your development provisioned machine. Apps signed for development will not be eligible for submission via App Store Connect.</p>
<h3><a class="anchor" id="autotoc_md519"></a>
Signing with <code>--deep</code></h3>
<p>Some subresources that you may include in your Electron app may need to be signed with <code>--deep</code>. This is not typically safe to apply to the entire Electron app and therefore should be applied to <em>just</em> your file.</p>
<div class="fragment"><div class="line">signAsync({</div>
<div class="line">  app: &#39;path/to/my.app&#39;,</div>
<div class="line">  optionsForFile: (filePath) =&gt; {</div>
<div class="line">    // For our one specific file we can pass extra options to be merged</div>
<div class="line">    // with the default options</div>
<div class="line">    if (path.basename(filePath) === &#39;myStrangeFile.jar&#39;) {</div>
<div class="line">      return {</div>
<div class="line">        additionalArguments: [&#39;--deep&#39;],</div>
<div class="line">      };</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    // Just use the default options for everything else</div>
<div class="line">    return null;</div>
<div class="line">  },</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md520"></a>
Signing legacy versions of Electron</h3>
<p><code>@electron/osx-sign</code> maintains backwards compatibility with older versions of Electron, but generally assumes that you are on the latest stable version.</p>
<p>If you are running an older unsupported version of Electron, you should pass in the <code>version</code> option as such:</p>
<div class="fragment"><div class="line">signAsync({</div>
<div class="line">  app: &#39;path/to/my.app&#39;,</div>
<div class="line">  version: &#39;0.34.0&#39;,</div>
<div class="line">});</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md521"></a>
Flat installer packaging</h1>
<p>This module also handles the creation of flat installer packages (<code>.pkg</code> installers).</p>
<dl class="section note"><dt>Note</dt><dd>Modern <code>.pkg</code> installers are also named "flat" packages for historical purposes. Prior to Mac OS X Leopard (10.5), installation packages were organized in hierarchical directories. OS X Leopard introduced a new flat package format that is used for modern <code>.pkg</code> installers.</dd></dl>
<h2><a class="anchor" id="autotoc_md522"></a>
API usage</h2>
<div class="fragment"><div class="line">const { flatAsync } = require(&#39;@electron/osx-sign&#39;)</div>
<div class="line">flatAsync({</div>
<div class="line">  app: &#39;path/to/my.app&#39;</div>
<div class="line">})</div>
<div class="line">  .then(function () {</div>
<div class="line">    // Application flattened</div>
<div class="line">  })</div>
<div class="line">  .catch(function (err) {</div>
<div class="line">    // Handle the error</div>
<div class="line">  })</div>
</div><!-- fragment --><p>The only mandatory option for <code>flatAsync</code> is a path to your <code>.app</code> package. For full configuration options, see the [API documentation].</p>
<h1><a class="anchor" id="autotoc_md523"></a>
CLI</h1>
<p><code>@electron/osx-sign</code> also exposes a legacy command-line interface (CLI) for both signing and installer generation. However, we recommend using the JavaScript API as it has a more complete API surface (e.g. <code>optionsForFile</code> is only available via JS).</p>
<div class="fragment"><div class="line"># install the package locally into devDependencies</div>
<div class="line">npm install --save-dev @electron/osx-sign</div>
<div class="line"> </div>
<div class="line"># Sign a packaged .app bundle</div>
<div class="line">npx electron-osx-sign path/to/my.app [options ...]</div>
<div class="line"> </div>
<div class="line"># Create a .pkg installer from a packaged .app bundle</div>
<div class="line">npx electron-osx-flat path/to/my.app [options ...]</div>
</div><!-- fragment --><p>For full options, use the <code>--help</code> flag for either command.</p>
<h1><a class="anchor" id="autotoc_md524"></a>
Debug</h1>
<p>The <a href="https://www.npmjs.com/package/debug"><code>debug</code></a> module is used to display advanced logs and messages. If you are having problems with signing your app with <code>@electron/osx-sign</code>, run your signing scripts with the <code>DEBUG=electron-osx-sign*</code> environment variable.</p>
<h1><a class="anchor" id="autotoc_md525"></a>
Test</h1>
<p>The project's configured to run automated tests on CircleCI.</p>
<p>If you wish to manually test the module, first comment out <code>opts.identity</code> in <code>test/basic.js</code> to enable auto discovery. Then run the command <code>npm test</code> from the dev directory.</p>
<p>When this command is run for the first time: <code>@electron/get</code> will download macOS Electron releases defined in <code>test/config.json</code>, and save to <code>~/.electron/</code>, which might take up less than 1GB of disk space.</p>
<p>A successful testing should look something like:</p>
<div class="fragment"><div class="line">$ npm test</div>
<div class="line"> </div>
<div class="line">&gt; electron-osx-sign@0.4.17 pretest electron-osx-sign</div>
<div class="line">&gt; rimraf test/work</div>
<div class="line"> </div>
<div class="line">&gt; electron-osx-sign@0.4.17 test electron-osx-sign</div>
<div class="line">&gt; standard &amp;&amp; tape test</div>
<div class="line"> </div>
<div class="line">Calling @electron/get before running tests...</div>
<div class="line">Running tests...</div>
<div class="line">TAP version 13</div>
<div class="line"># setup</div>
<div class="line"># defaults-test:v7.0.0-beta.3-darwin-x64</div>
<div class="line">ok 1 app signed</div>
<div class="line"># defaults-test:v7.0.0-beta.3-mas-x64</div>
<div class="line">ok 2 app signed</div>
<div class="line"># defaults-test:v6.0.3-darwin-x64</div>
<div class="line">ok 3 app signed</div>
<div class="line"># defaults-test:v6.0.3-mas-x64</div>
<div class="line">ok 4 app signed</div>
<div class="line"># defaults-test:v5.0.10-darwin-x64</div>
<div class="line">ok 5 app signed</div>
<div class="line"># defaults-test:v5.0.10-mas-x64</div>
<div class="line">ok 6 app signed</div>
<div class="line"># defaults-test:v4.2.9-darwin-x64</div>
<div class="line">ok 7 app signed</div>
<div class="line"># defaults-test:v4.2.9-mas-x64</div>
<div class="line">ok 8 app signed</div>
<div class="line"># defaults-test:v3.1.2-darwin-x64</div>
<div class="line">ok 9 app signed</div>
<div class="line"># defaults-test:v3.1.2-mas-x64</div>
<div class="line">ok 10 app signed</div>
<div class="line"># teardown</div>
<div class="line"> </div>
<div class="line">1..10</div>
<div class="line"># tests 10</div>
<div class="line"># pass  10</div>
<div class="line"> </div>
<div class="line"># ok</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
